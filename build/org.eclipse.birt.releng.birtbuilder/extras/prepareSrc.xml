<project name="test" default="prepareSrc">

	<!-- ${dtp.mapCvsRoot}and ${dtp.mapVersionTag} will be overwriten by value 
		in bootstrap.sh -->
	<property name="dtp.mapGitRoot" value="ssh://xgu@git.eclipse.org/gitroot/datatools" />
	<property name="dtp.mapVersionTag" value="master" />

	<target name="prepareSrc">
		<antcall target="prepare.features" />
	</target>

	<target name="prepare.features">
		<copy todir="${buildDirectory}/features/org.eclipse.birt"
			failonerror="false">
			<fileset dir="${buildDirectory}/source/features/org.eclipse.birt.feature" />
		</copy>
		<copy todir="${buildDirectory}/features/org.eclipse.birt.cshelp"
			failonerror="false">
			<fileset
				dir="${buildDirectory}/source/features/org.eclipse.birt.cshelp.feature" />
		</copy>
		<copy todir="${buildDirectory}/features/org.eclipse.birt.doc"
			failonerror="false">
			<fileset
				dir="${buildDirectory}/source/features/org.eclipse.birt.doc.feature" />
		</copy>
		<copy todir="${buildDirectory}/features/org.eclipse.birt.example"
			failonerror="false">
			<fileset
				dir="${buildDirectory}/source/features/org.eclipse.birt.example.feature" />
		</copy>
		<copy todir="${buildDirectory}/features/org.eclipse.birt.integration.wtp"
			failonerror="false">
			<fileset
				dir="${buildDirectory}/source/features/org.eclipse.birt.integration.wtp.feature" />
		</copy>
		<copy
			todir="${buildDirectory}/features/org.eclipse.birt.integration.wtp.sdk"
			failonerror="false">
			<fileset
				dir="${buildDirectory}/source/features/org.eclipse.birt.integration.wtp.sdk.feature" />
		</copy>
		<copy todir="${buildDirectory}/features/org.eclipse.birt.osgi.runtime"
			failonerror="false">
			<fileset
				dir="${buildDirectory}/source/features/org.eclipse.birt.osgi.runtime" />
		</copy>
		<copy todir="${buildDirectory}/features/org.eclipse.birt.osgi.runtime.sdk"
			failonerror="false">
			<fileset
				dir="${buildDirectory}/source/features/org.eclipse.birt.osgi.runtime.sdk" />
		</copy>
		<copy
			todir="${buildDirectory}/features/org.eclipse.birt.report.designer.editor.xml.wtp"
			failonerror="false">
			<fileset
				dir="${buildDirectory}/source/features/org.eclipse.birt.report.designer.editor.xml.wtp.feature" />
		</copy>
		<copy todir="${buildDirectory}/features/org.eclipse.birt.sdk"
			failonerror="false">
			<fileset
				dir="${buildDirectory}/source/features/org.eclipse.birt.sdk.feature" />
		</copy>
		<copy todir="${buildDirectory}/features/org.eclipse.birt.testhelper"
			failonerror="false">
			<fileset
				dir="${buildDirectory}/source/features/org.eclipse.birt.testhelper.feature" />
		</copy>
		<copy todir="${buildDirectory}/features/org.eclipse.birt.tests"
			failonerror="false">
			<fileset
				dir="${buildDirectory}/source/features/org.eclipse.birt.tests.feature" />
		</copy>
	</target>

	<target name="updateBatik">
		<replace dir="${buildDirectory}/maps" value="org.apache.batik.bridge,1.7.0"
			token="org.apache.batik.bridge,1.6.0">
			<include name="**/*.map" />
		</replace>
		<replace dir="${buildDirectory}/maps" value="org.apache.batik.bridge_1.7.0.v200912221625.jar"
			token="org.apache.batik.bridge_1.6.0.v200912221622.jar">
			<include name="**/*.map" />
		</replace>

		<replace dir="${buildDirectory}/maps" value="org.apache.batik.css,1.7.0"
			token="org.apache.batik.css,1.6.0">
			<include name="**/*.map" />
		</replace>
		<replace dir="${buildDirectory}/maps" value="org.apache.batik.css_1.7.0.v200912221625.jar"
			token="org.apache.batik.css_1.6.0.v200912221622.jar">
			<include name="**/*.map" />
		</replace>

		<replace dir="${buildDirectory}/maps" value="org.apache.batik.dom,1.7.0"
			token="org.apache.batik.dom,1.6.0">
			<include name="**/*.map" />
		</replace>
		<replace dir="${buildDirectory}/maps" value="org.apache.batik.dom_1.7.0.v200912221625.jar"
			token="org.apache.batik.dom_1.6.0.v200912221622.jar">
			<include name="**/*.map" />
		</replace>

		<replace dir="${buildDirectory}/maps" value="org.apache.batik.dom.svg,1.7.0"
			token="org.apache.batik.dom.svg,1.6.0">
			<include name="**/*.map" />
		</replace>
		<replace dir="${buildDirectory}/maps"
			value="org.apache.batik.dom.svg_1.7.0.v200903091627.jar" token="org.apache.batik.dom.svg_1.6.0.v200805290154.jar">
			<include name="**/*.map" />
		</replace>

		<replace dir="${buildDirectory}/maps" value="org.apache.batik.ext.awt,1.7.0"
			token="org.apache.batik.ext.awt,1.6.0">
			<include name="**/*.map" />
		</replace>
		<replace dir="${buildDirectory}/maps"
			value="org.apache.batik.ext.awt_1.7.0.v200903091627.jar" token="org.apache.batik.ext.awt_1.6.0.v200805290154.jar">
			<include name="**/*.map" />
		</replace>

		<replace dir="${buildDirectory}/maps" value="org.apache.batik.parser,1.7.0"
			token="org.apache.batik.parser,1.6.0">
			<include name="**/*.map" />
		</replace>
		<replace dir="${buildDirectory}/maps" value="org.apache.batik.parser_1.7.0.v200903091627.jar"
			token="org.apache.batik.parser_1.6.0.v200805290154.jar">
			<include name="**/*.map" />
		</replace>

		<replace dir="${buildDirectory}/maps" value="org.apache.batik.svggen,1.7.0"
			token="org.apache.batik.svggen,1.6.0">
			<include name="**/*.map" />
		</replace>
		<replace dir="${buildDirectory}/maps" value="org.apache.batik.svggen_1.7.0.v200903091627.jar"
			token="org.apache.batik.svggen_1.6.0.v200805290154.jar">
			<include name="**/*.map" />
		</replace>

		<replace dir="${buildDirectory}/maps" value="org.apache.batik.transcoder,1.7.0"
			token="org.apache.batik.transcoder,1.6.0">
			<include name="**/*.map" />
		</replace>
		<replace dir="${buildDirectory}/maps"
			value="org.apache.batik.transcoder_1.7.0.v200903091627.jar" token="org.apache.batik.transcoder_1.6.0.v200805290154.jar">
			<include name="**/*.map" />
		</replace>

		<replace dir="${buildDirectory}/maps" value="org.apache.batik.util,1.7.0"
			token="org.apache.batik.util,1.6.0">
			<include name="**/*.map" />
		</replace>
		<replace dir="${buildDirectory}/maps" value="org.apache.batik.util_1.7.0.v200903091627.jar"
			token="org.apache.batik.util_1.6.0.v200805290154.jar">
			<include name="**/*.map" />
		</replace>

		<replace dir="${buildDirectory}/maps" value="org.apache.batik.util.gui,1.7.0"
			token="org.apache.batik.util.gui,1.6.0">
			<include name="**/*.map" />
		</replace>
		<replace dir="${buildDirectory}/maps"
			value="org.apache.batik.util.gui_1.7.0.v200903091627.jar" token="org.apache.batik.util.gui_1.6.0.v200805290154.jar">
			<include name="**/*.map" />
		</replace>

		<replace dir="${buildDirectory}/maps" value="org.apache.batik.xml,1.7.0"
			token="org.apache.batik.xml,1.6.0">
			<include name="**/*.map" />
		</replace>
		<replace dir="${buildDirectory}/maps" value="org.apache.batik.xml_1.7.0.v200903091627.jar"
			token="org.apache.batik.xml_1.6.0.v200805290154.jar">
			<include name="**/*.map" />
		</replace>

		<replace dir="${buildDirectory}/maps" value="org.w3c.css.sac,1.3.1"
			token="org.w3c.css.sac,1.3.0">
			<include name="**/*.map" />
		</replace>
		<replace dir="${buildDirectory}/maps" value="org.w3c.css.sac_1.3.1.v200903091627.jar"
			token="org.w3c.css.sac_1.3.0.v200805290154.jar">
			<include name="**/*.map" />
		</replace>

		<replace dir="${buildDirectory}/maps" value="!***plugin@org.apache.batik.pdf"
			token="plugin@org.apache.batik.pdf">
			<include name="**/*.map" />
		</replace>
	</target>
	<target name="updateBatikFeature">
		<replace dir="${buildDirectory}/features">
			<replacetoken><![CDATA[<!-- PLACEHOLDER FOR org.w3c.dom.events -->]]></replacetoken>
			<replacevalue><![CDATA[<plugin
	     id="org.w3c.dom.events"
	     download-size="0"
	     install-size="0"
	     version="0.0.0"
	     unpack="false"/>]]></replacevalue>
			<include name="**/feature.xml" />
		</replace>
		<replace dir="${buildDirectory}/features">
			<replacetoken><![CDATA[<plugin id="org.apache.batik.pdf" download-size="0" install-size="0" version="0.0.0" unpack="false"/>]]></replacetoken>
			<replacevalue><![CDATA[<plugin id="org.apache.batik.pdf" download-size="0" install-size="0" version="0.0.0" unpack="true"/>]]></replacevalue>
			<include name="**/feature.xml" />
		</replace>
	</target>
</project>
